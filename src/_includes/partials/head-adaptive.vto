<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>{{ title || "Progressive Islands Template" }}</title>
<meta name="description" content="{{ description || 'Clean starting template for progressive island architecture' }}">

<!-- Load bolt.css for clean, classless styling -->
<link rel="stylesheet" href="/assets/css/main.css">

{{ if page.url !== "/" }}
<!-- Main JS bundle for islands (non-landing pages only) -->
<script type="module" src="/assets/main.js"></script>
{{ /if }}

<!-- Critical theme initialization to prevent FOUC -->
<script>
  // Initialize theme immediately to prevent flash
  (function() {
    const saved = localStorage.getItem('theme');
    const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = saved || (systemDark ? 'dark' : 'light');
    document.documentElement.setAttribute('data-theme', theme);
  })();
</script>

<!-- Theme system script with toggle functionality -->
<script>
  // Theme toggle function with local storage support
  function cycleTheme() {
    const html = document.documentElement;
    const current = html.getAttribute('data-theme') || 
                   (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    const newTheme = current === 'dark' ? 'light' : 'dark';
    
    html.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    
    // Update button icon
    document.querySelectorAll('.theme-toggle').forEach(button => {
      button.innerHTML = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
      button.setAttribute('aria-label', `Switch to ${newTheme === 'dark' ? 'light' : 'dark'} theme`);
    });
  }

  // Initialize theme toggle buttons when DOM loads
  function initThemeButtons() {
    const theme = document.documentElement.getAttribute('data-theme') || 'light';
    
    // Set up theme toggle buttons
    document.querySelectorAll('.theme-toggle').forEach(button => {
      button.addEventListener('click', cycleTheme);
      button.innerHTML = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
      button.setAttribute('aria-label', `Switch to ${theme === 'dark' ? 'light' : 'dark'} theme`);
    });
  }

  // Initialize buttons when DOM loads
  document.addEventListener('DOMContentLoaded', initThemeButtons);
</script>
